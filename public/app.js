(()=>{"use strict";const t={W:1454,H:765};function s(s,i){i.setTransform(1,0,0,1,0,0);let o=s.width,e=s.height;o!==t.W||e!==t.H?(o=s.width=t.W,e=s.height=t.H):i.clearRect(0,0,o,e)}function i(t,i,o,e,n){t.setCursor("default"),s(i,o),e.mouse.isCreating?e.drawTracer(0):e.isSomePointIsntSettled()||e.isNotInDrawingRange()?n.isDragging&&n.dragMove(t,e):(e.drawPoints(n),e.drawLine(),n.dragDetect(t,e),n.dragMove(t,e))}const o=new class{canvas=null;ctx=null;constructor(t){this.canvas=t,this.setContext(this.canvas.getContext("2d"))}setCursor(t){this.canvas&&(this.canvas.style.cursor=t)}setContext(t){this.ctx=t}getContext(){return this.ctx}}(canvas),e=o.canvas,n=o.getContext(),h=new class{ctx=null;color="#fff";points=new Array(6).fill(0);mouse={x:0,y:0,button:!1,point:0,isCreating:!1};constructor(t){this.ctx=t}drawPoint(t,s,i){this.ctx&&(this.ctx.strokeStyle=this.color,this.ctx.beginPath(),this.ctx.arc(t,s,i,0,2*Math.PI),this.ctx.stroke())}drawPoints(t,s="#aef193"){this.setColor(s),t.nearest=-1;let i,o,e=0,n=20;for(;e<this.points.length;){this.drawPoint(i=this.points[e++],o=this.points[e++],6);const s=(i-this.mouse.x)**2+(o-this.mouse.y)**2;s<n&&(n=s,t.nearest=e-2)}}drawTracer(t,s="#fff"){this.ctx&&(this.setColor(s),this.drawPoint(this.points[t++],this.points[t++],6),this.drawPoint(this.mouse.x,this.mouse.y,6),this.ctx.strokeStyle=this.color,this.ctx.beginPath(),this.ctx.lineTo(this.points[0],this.points[1]),this.ctx.lineTo(this.mouse.x,this.mouse.y),this.ctx.stroke())}drawLine(t="#fff"){if(!this.ctx)return;this.setColor(t),this.ctx.strokeStyle=this.color,this.ctx.beginPath();const s=function([t,s,i,o,e,n]){let h,r,a;const c=(i-t)/(s-o),u=(e-i)/(o-n);return c===u?null:(s===o?(h=(t+i)/2,r=u*h+((o+n)/2-u*((i+e)/2))):o===n?(h=(i+e)/2,r=c*h+((s+o)/2-c*((t+i)/2))):(h=((o+n)/2-u*((i+e)/2)-(a=(s+o)/2-c*((t+i)/2)))/(c-u),r=c*h+a),{x:h,y:r,radius:Math.sqrt((t-h)**2+(s-r)**2),CCW:(e-t)*(o-s)-(n-s)*(i-t)>=0})}(this.points);if(s){const t=Math.atan2(this.points[1]-s.y,this.points[0]-s.x),i=Math.atan2(this.points[5]-s.y,this.points[4]-s.x);this.ctx.arc(s.x,s.y,s.radius,t,i,s.CCW)}else this.ctx.lineTo(this.points[0],this.points[1]),this.ctx.lineTo(this.points[2],this.points[3]),this.ctx.lineTo(this.points[4],this.points[5]);this.ctx.stroke()}setPoints(){this.mouse.point<1?(this.mouse.isCreating=!0,this.points[this.mouse.point++]=this.mouse.x,this.points[this.mouse.point++]=this.mouse.y):(this.points[this.mouse.point++]=this.calculateMiddlePointCoordinate(this.mouse.x),this.points[this.mouse.point++]=this.calculateMiddlePointCoordinate(this.mouse.y),this.points[this.mouse.point++]=this.mouse.x,this.points[this.mouse.point++]=this.mouse.y,this.mouse.point=0,this.mouse.isCreating=!1)}calculateMiddlePointCoordinate(t){return this.points[this.mouse.point-3]+(t-this.points[this.mouse.point-3])/2}isNotInDrawingRange(){const s=[...this.points];return s.splice(2,2),s[0]>t.W||s[2]>t.W||s[1]>t.H||s[3]>t.H}isSomePointIsntSettled(){return this.points.some((t=>t<0))}setColor(t){this.color=t}}(n),r=new class{ctx=null;nearest;dragIdx;ox;oy;isDragging;constructor(t){this.ctx=t}dragDetect(t,s){this.nearest>-1&&(s.mouse.button?this.isDragging||(this.isDragging=!0,this.ox=s.points[this.nearest]-s.mouse.x,this.oy=s.points[this.nearest+1]-s.mouse.y,this.dragIdx=this.nearest):t.setCursor("move"),s.drawPoint(s.points[this.nearest],s.points[this.nearest+1],6,"red"))}dragMove(t,s){this.isDragging&&(s.mouse.button?(s.points[this.dragIdx]=s.mouse.x+this.ox,s.points[this.dragIdx+1]=s.mouse.y+this.oy,t.setCursor("none")):this.isDragging=!1)}}(n);requestAnimationFrame((()=>i(o,e,n,h,r))),["mousedown","mouseup","mousemove","click"].map((t=>document.addEventListener(t,(t=>{requestAnimationFrame((()=>i(o,e,n,h,r))),function(t,s,i,o){const e=s.getBoundingClientRect();i.mouse.x=t.pageX-e.left-scrollX,i.mouse.y=t.pageY-e.top-scrollY,"click"!==t.type||o.isDragging||i.setPoints(i.points,i.mouse),i.mouse.button="mousedown"===t.type||"mouseup"!==t.type&&i.mouse.button}(t,e,h,r)})))),["keydown"].map((t=>document.addEventListener(t,(t=>function(t,i,o,e){"Escape"===t.key&&function(t,i,o){s(t,i),o.mouse.isCreating=!1,o.points.fill(0),o.mouse.point=0}(i,o,e)}(t,e,n,h)))))})();